<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>BrickStock - Rangements</title>
        <link rel="stylesheet" type="text/css" href="/BrickStock/css/styles.css">
        <!-- <link rel="stylesheet" type="text/css" href="../css/styles.css"> -->
        <link rel="shortcut icon" href="/BrickStock/css/favicon.ico" type="image/x-icon">
        <!-- <link rel="shortcut icon" href="../css/favicon.ico" type="image/x-icon"> -->
        <style type="text/css">
            td.col1 {
                text-align: right;
            }
            td.col2 {
                text-align: left;
            }
            tr.border td {
                border-top: 1px solid #929292;
                padding-top: 20px;
            }
            tr.sub_border td {
                padding-bottom: 20px;
            }
        </style>
    </head>
    <body>
        <div class="page">
            <div class="menu">
                <ul>
                    <li>
                        <a href="/BrickStock/pieces">Pièces</a></li><li>
                        <a href="/BrickStock/designs">Designs</a></li><li>
                        <a href="/BrickStock/categories">Categories</a></li><li>
                        <a href="/BrickStock/couleurs">Couleurs</a></li><li class="main">
                        <a href="/BrickStock/rangements">Rangements</a></li><li>
                        <a href="/BrickStock/sets">Sets</a></li><li>
                        <a href="/BrickStock/minifigures">Minifigures</a>
                    </li>
                </ul>
            </div>
            <div class="layout">
                <h2 style="padding: 20px;">Paramètres de la page&nbsp;:</h2>
                <form type="POST" style="padding: 0 20px 20px">
                    <table style="border-collapse: collapse;">
                        <tbody>
                            <tr>
                                <td class="col1">
                                    <span>Taille du papier&nbsp;:</span>
                                </td>
                                <td class="col2">
                                    <select name="dimensions_page" id="dimensions_page"></select><span id="tailles_standards" style="font-size: 12px; vertical-align: middle;"></span>
                                </td>
                            </tr>
                            <tr>
                                <td class="col1">
                                    <span>OU</span>
                                </td>
                                <td class="col2"></td>
                            </tr>
                            <tr>
                                <td class="col1" style="vertical-align: top;">
                                    <span style="padding-top: 2.5px; display: inline-block;">Format de page personnalisé&nbsp;:</span>
                                </td>
                                <td class="col2" style="vertical-align: top;">
                                    <table style="text-align: center;">
                                        <tbody>
                                            <tr>
                                                <td>Largeur (mm)&nbsp;:</td>
                                                <td>&nbsp;&nbsp;x&nbsp;&nbsp;</td>
                                                <td>Hauteur (mm)&nbsp;:</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <input type="text" placeholder="210, 297, 105 ..." id="width" name="page_width" style="width: 96px; text-align: center;">
                                                </td>
                                                <td>&nbsp;&nbsp;x&nbsp;&nbsp;</td>
                                                <td>
                                                    <input type="text" placeholder="210, 297, 105 ..." id="height" name="page_height" style="width: 96px; text-align: center;">
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                            <tr class="sub_border">
                                <td class="col1">
                                    <span>Orientation&nbsp;:</span>
                                </td>
                                <td class="col2">
                                    <img style="width: 50px; margin-right: 6.25px; cursor: pointer;" id="bouton_portrait"><img style="width: 50px; margin-left: 6.25px; cursor: pointer" id="bouton_paysage">
                                    <input type="hidden" name="orientation_page" value="portrait" id="input_orientation_page">
                                </td>
                            </tr>
                            <tr class="border">
                                <td class="col1">
                                    <span>Largeur des QR-Codes (cm)&nbsp;:</span>
                                </td>
                                <td>
                                    <input type="text" placeholder="25, 32, 45 ..." name="qrcode_size" id="qrcode_width">
                                </td>
                            </tr>
                            <tr>
                                <td class="col1">
                                    <span>Nombre de QR-Codes par ligne*&nbsp;:</span><br/>
                                </td>
                                <td class="col2">
                                    <input type="number" min="1" name="nb_qrcode_par_ligne" placeholder="auto">
                                </td>
                            </tr>
                            <tr class="sub_border">
                                <td class="col1">
                                    <i style="font-size: 10px; width: auto; max-width: 236px; display: inline-block;">*ce nombre est suceptible d'être adapté en fonction de la taille des qr-codes</i>
                                </td>
                                <td class="col2"></td>
                            </tr>
                            <tr class="border">
                                <td class="col1"></td>
                                <td class="col1">
                                    <input style="cursor: pointer;" type="submit" value="Télécharger">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
        <script type="text/javascript" name="remplissage des formats de papier">
            let formatStandards = {FORMATS_STANDARDS};
            let selectDimensionsPage = document.getElementById("dimensions_page");
            var listeKeys = Object.keys(formatStandards);

            for (var i=0; i<listeKeys.length; i++) {
                var option = document.createElement("option");
                option.value = listeKeys[i];
                option.innerHTML = listeKeys[i];
                selectDimensionsPage.appendChild(option);
            }
            selectDimensionsPage.value = "A4";

            let taillesStandards = document.getElementById("tailles_standards");

            function setTaille() {
                var val = formatStandards.value;
                if (!listeKeys.includes(val)) {
                    formatStandards.value = "A4";
                    setTaille();
                    return
                }
                taillesStandards.innerHTML = " " + formatStandards[val][0] + " par " + formatStandards[val][1] + " mm";
            }

            setTaille();
            selectDimensionsPage.addEventListener("input", setTaille);

            let width = document.getElementById("width");
            let height = document.getElementById("height");
            let w = 210;
            let h = 297;
            let qr = 40;
            let floatCar = "0123456789.";

            function verifInput(e) {
                var val = this.value;
                val = val.replace(",", ".");
                for (var i=0; i<val.length; i++) {
                    if (!floatCar.includes(val[i])) {
                        if (this.id == "width") {
                            this.value = w;
                        }
                        else if (this.id == "height") {
                            this.value = h;
                        }
                        else {
                            this.value = qr;
                        }
                        return;
                    }
                }
                if (this.id == "width") {
                    w = val;
                }
                else if (this.id == "height") {
                    h = val;
                }
                else {
                    qr = val;
                }
            }

            width.addEventListener("input", verifInput);
            height.addEventListener("input", verifInput);
            document.getElementById("qrcode_width").addEventListener("input", verifInput);
        </script>
        <script type="text/javascript" name="gestion des boutons d'orientation de la page">
            let imgSrc = {"portrait" : {true : "/BrickStock/images/format_portrait_selected.png", false : "/BrickStock/images/format_portrait.png"}, "paysage" : {true : "/BrickStock/images/format_paysage_selected.png", false : "/BrickStock/images/format_paysage.png"}};

            let boutonPortrait = document.getElementById("bouton_portrait");
            let boutonPaysage = document.getElementById("bouton_paysage");
            let inputOrientationPage = document.getElementById("input_orientation_page");

            boutonPortrait.src = imgSrc["portrait"][true];
            boutonPaysage.src = imgSrc["paysage"][false];

            function setImgSrc(e) {
                boutonPortrait.src = imgSrc["portrait"][false];
                boutonPaysage.src = imgSrc["paysage"][false];
                this.src = imgSrc[this.id.substring(7)][true];
                inputOrientationPage.value = this.id.substring(7);
            }

            boutonPortrait.addEventListener("click", setImgSrc);
            boutonPaysage.addEventListener("click", setImgSrc);
        </script>
        {script}
    </body>
</html>